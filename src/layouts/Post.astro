---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import Base from './Base.astro';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import FormattedDate from '../components/FormattedDate.astro';
import Header from '../components/Header.astro';
import SignedComments from '../components/SignedComments.astro';
import XOChainLinks from '../components/XOChainLinks.astro';

interface Props {
  entry: CollectionEntry<'blog'>;
  postUrl: string;
  vaultVerified?: boolean;
}

const { entry, postUrl, vaultVerified = false } = Astro.props;
const { title, description, pubDate, updatedDate, heroImage, vault_url, ledger_day, digest_day } = entry.data;
---

<Base title={title}>
  <Fragment slot="head">
    <BaseHead title={title} description={description} image={heroImage} />
  </Fragment>
  <Header />
  <article class="card" style="margin-top: 1.5rem;">
    {heroImage && (
      <p style="margin: 0 0 1rem 0;">
        <Image src={heroImage} alt="" width={1020} height={510} style="max-width: 100%; height: auto; border-radius: var(--radius);" />
      </p>
    )}
    <p class="muted" style="margin: 0 0 0.25rem 0;">
      <FormattedDate date={pubDate} />
      {updatedDate && (
        <span> Â· Updated <FormattedDate date={updatedDate} /></span>
      )}
    </p>
    <h1 style="margin: 0 0 1rem 0;">{title}</h1>
    <div class="hr" />
    <slot />
    <XOChainLinks
      vaultUrl={vault_url}
      ledgerDay={ledger_day}
      digestDay={digest_day}
      pubDate={pubDate}
      vaultVerified={vaultVerified}
    />
    <SignedComments postUrl={postUrl} />
  </article>
  <Footer />
</Base>
